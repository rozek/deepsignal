require("@preact/signals-react");var e=require("react"),t=require("@preact/signals-core"),r=new WeakMap,n=new WeakMap,a=new WeakMap,o=new WeakSet,c=new WeakMap,s=/^\$/,i=!1,l=function(e){if(!b(e))throw new Error("This object can't be observed.");return n.has(e)||n.set(e,u(e,h)),n.get(e)},u=function(e,t){var r=new Proxy(e,t);return o.add(r),r},p=function(){throw new Error("Don't mutate the signals directly.")},f=function(e){return function(o,c,l){var p;if(i)return Reflect.get(o,c,l);var f=e||"$"===c[0]&&"$"!==c;if(!e&&f&&Array.isArray(o)){if("$"===c)return a.has(o)||a.set(o,u(o,y)),a.get(o);f="$length"===c}r.has(l)||r.set(l,new Map);var v=r.get(l),w=f?c.replace(s,""):c;if(v.has(w)||"function"!=typeof(null==(p=Object.getOwnPropertyDescriptor(o,w))?void 0:p.get)){var d=Reflect.get(o,w,l);if(f&&"function"==typeof d)return;if("symbol"==typeof w&&g.has(w))return d;v.has(w)||(b(d)&&(n.has(d)||n.set(d,u(d,h)),d=n.get(d)),v.set(w,t.signal(d)))}else v.set(w,t.computed(function(){return Reflect.get(o,w,l)}));return f?v.get(w):v.get(w).value}},h={get:f(!1),set:function(e,a,o,c){r.has(c)||r.set(c,new Map);var i=r.get(c);if("$"===a[0]&&"$"!==a){o instanceof t.Signal||p();var l=a.replace(s,"");return i.set(l,o),Reflect.set(e,l,o.peek(),c)}var f=o;b(o)&&(n.has(o)||n.set(o,u(o,h)),f=n.get(o));var y=Reflect.set(e,a,o,c);return i.has(a)?i.get(a).value=f:i.set(a,t.signal(f)),Array.isArray(e)&&i.has("length")&&(i.get("length").value=e.length),y},defineProperty:function(e,t,a){"$"===t[0]&&"$"!==t&&p();var o=!(t in e),s=r.get(n.get(e)),i=Reflect.defineProperty(e,t,a);return"value"in a&&s&&s.has(t)&&(s.get(t).value=a.value),o&&c.has(e)&&c.get(e).value++,i},deleteProperty:function(e,t){"$"===t[0]&&"$"!==t&&p();var a=r.get(n.get(e)),o=Reflect.deleteProperty(e,t);return a&&a.has(t)&&(a.get(t).value=void 0),c.has(e)&&c.get(e).value++,o},ownKeys:function(e){return c.has(e)||c.set(e,t.signal(0)),c._=c.get(e).value,Reflect.ownKeys(e)}},y={get:f(!0),set:p,deleteProperty:p},g=new Set(Object.getOwnPropertyNames(Symbol).map(function(e){return Symbol[e]}).filter(function(e){return"symbol"==typeof e})),v=new Set([Object,Array]),b=function(e){return"object"==typeof e&&null!==e&&(!("function"==typeof e.constructor&&e.constructor.name in globalThis&&globalThis[e.constructor.name]===e.constructor)||v.has(e.constructor))&&!o.has(e)};function w(e){return o.has(e)}var d=Array.prototype.pop;Array.prototype.pop=function(){var e,r=this;return w(this)?(t.batch(function(){e=d.call(r)}),e):d.call(this)};var A=Array.prototype.shift;Array.prototype.shift=function(){var e,r=this;return w(this)?(t.batch(function(){e=A.call(r)}),e):A.call(this)};var m=Array.prototype.unshift;Array.prototype.unshift=function(){var e,r=this,n=[].slice.call(arguments);return w(this)?(t.batch(function(){e=m.call.apply(m,[r].concat(n))}),e):m.call.apply(m,[this].concat(n))};var $=Array.prototype.splice;Array.prototype.splice=function(){var e,r=this,n=[].slice.call(arguments);return w(this)?(t.batch(function(){e=$.call.apply($,[r].concat(n))}),e):$.call.apply($,[this].concat(n))},exports.ValueIsDeeplyObserved=w,exports.deepSignal=l,exports.peek=function(e,t){i=!0;var r=e[t];try{i=!1}catch(e){}return r},exports.useDeepSignal=function(t){return e.useMemo(function(){return l(t)},[])};
//# sourceMappingURL=deepsignal-react.js.map
