require("@preact/signals-react");var e=require("react"),t=require("@preact/signals-core"),r=new WeakMap,n=new WeakMap,a=new WeakMap,o=new WeakSet,s=new WeakMap,u=/^\$/,i=!1,c=function(e){if(!w(e))throw new Error("This object can't be observed.");return n.has(e)||n.set(e,l(e,p)),n.get(e)},l=function(e,t){var r=new Proxy(e,t);return o.add(r),r},f=function(){throw new Error("Don't mutate the signals directly.")},g=function(e){return function(o,s,c){var f;if(i)return Reflect.get(o,s,c);var g=e||"$"===s[0];if(!e&&g&&Array.isArray(o)){if("$"===s)return a.has(o)||a.set(o,l(o,h)),a.get(o);g="$length"===s}r.has(c)||r.set(c,new Map);var y=r.get(c),b=g?s.replace(u,""):s;if(y.has(b)||"function"!=typeof(null==(f=Object.getOwnPropertyDescriptor(o,b))?void 0:f.get)){var d=Reflect.get(o,b,c);if(g&&"function"==typeof d)return;if("symbol"==typeof b&&v.has(b))return d;y.has(b)||(w(d)&&(n.has(d)||n.set(d,l(d,p)),d=n.get(d)),y.set(b,t.signal(d)))}else y.set(b,t.computed(function(){return Reflect.get(o,b,c)}));return g?y.get(b):y.get(b).value}},p={get:g(!1),set:function(e,a,o,s){r.has(s)||r.set(s,new Map);var i=r.get(s);if("$"===a[0]){o instanceof t.Signal||f();var c=a.replace(u,"");return i.set(c,o),Reflect.set(e,c,o.peek(),s)}var g=o;w(o)&&(n.has(o)||n.set(o,l(o,p)),g=n.get(o));var h=Reflect.set(e,a,o,s);return i.has(a)?i.get(a).value=g:i.set(a,t.signal(g)),Array.isArray(e)&&i.has("length")&&(i.get("length").value=e.length),h},defineProperty:function(e,t,a){"$"===t[0]&&"$"!==t&&f();var o=!(t in e),u=r.get(n.get(e)),i=Reflect.defineProperty(e,t,a);return"value"in a&&u&&u.has(t)&&(u.get(t).value=a.value),o&&s.has(e)&&s.get(e).value++,i},deleteProperty:function(e,t){"$"===t[0]&&f();var a=r.get(n.get(e)),o=Reflect.deleteProperty(e,t);return a&&a.has(t)&&(a.get(t).value=void 0),s.has(e)&&s.get(e).value++,o},ownKeys:function(e){return s.has(e)||s.set(e,t.signal(0)),s.get(e).value=s.get(e).value,Reflect.ownKeys(e)}},h={get:g(!0),set:f,deleteProperty:f},v=new Set(Object.getOwnPropertyNames(Symbol).map(function(e){return Symbol[e]}).filter(function(e){return"symbol"==typeof e})),y=new Set([Object,Array]),w=function(e){return"object"==typeof e&&null!==e&&(!("function"==typeof e.constructor&&e.constructor.name in globalThis&&globalThis[e.constructor.name]===e.constructor)||y.has(e.constructor))&&!o.has(e)};exports.deepSignal=c,exports.peek=function(e,t){return i=!0,i=!1,e[t]},exports.useDeepSignal=function(t){return e.useMemo(function(){return c(t)},[])};
//# sourceMappingURL=deepsignal-react.js.map
